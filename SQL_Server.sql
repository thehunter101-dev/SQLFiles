--- Creacion de base de datos
CREATE DATABASE NOVICOMPUT
ON (NAME='NOVICOMPUT',FILENAME='/var/opt/mssql/data/NOVICOMPUT.mdf', SIZE=10MB, MAXSIZE=20MB,FILEGROWTH=1MB)
LOG ON (NAME='NOVICOMPUT_LOG', FILENAME='/var/opt/mssql/data/NOVICOMPUT.ldf');

---Creacion de Tablas---
CREATE TABLE PRODUCTO
(
    IDPRODUCTO INT PRIMARY KEY IDENTITY,
    IDCATEGORIA INT NOT NULL,
    NOMBRE VARCHAR(20) NOT NULL,
    STOCK INT NOT NULL,
    ACTIVO BIT NOT NULL
)

CREATE TABLE PRODUCTODETALLE
(
    IDPRODUCTODETALLE INT PRIMARY KEY,
    IDPRODUCTO INT NOT NULL,
    DESCRIPCION VARCHAR(200) NOT NULL
)

CREATE TABLE  PROVEEDOR
(
    IDPROVEDOR INT PRIMARY KEY IDENTITY,
    NOMBRES VARCHAR(100) NOT NULL,
    RUC VARCHAR(13) NOT NULL,
    TELEFONO VARCHAR(10) NOT NULL,
    EMAIL VARCHAR(50) NOT NULL,
    FECHA_CREACION DATE NOT NULL
)

-- CREAR TABLA COMPRA 
GO
CREATE TABLE COMPRA
(
    IDCOMPRA INT PRIMARY KEY IDENTITY,
    FECHA_REGISTRO DATE NOT NULL,
    SUBTOTAL REAL NOT NULL,
    IVA REAL,
    DSCTO REAL,
    TOTAL REAL,
    PAGADO BIT
);
GO
--INSERCIONES DE COMPRA
INSERT INTO COMPRA (FECHA_REGISTRO, SUBTOTAL, IVA, DSCTO, TOTAL, PAGADO) VALUES
('2025-01-01', 120.50, 14.46, 5.00, 129.96, 1),('2025-01-02', 200.00, 24.00, 0.00, 224.00, 0),('2025-01-03', 75.00, 9.00, 2.00, 82.00, 1),('2025-01-04', 300.00, 36.00, 10.00, 326.00, 1),
('2025-01-05', 450.00, 54.00, 20.00, 484.00, 0),('2025-01-06', 95.20, 11.42, 0.00, 106.62, 1),('2025-01-07', 180.00, 21.60, 5.00, 196.60, 1),('2025-01-08', 210.50, 25.26, 0.00, 235.76, 0),('2025-01-09', 60.00, 7.20, 0.00, 67.20, 1),
('2025-01-10', 155.00, 18.60, 3.00, 170.60, 1),('2025-01-11', 400.00, 48.00, 10.00, 438.00, 0),('2025-01-12', 50.00, 6.00, 0.00, 56.00, 1),('2025-01-13', 275.00, 33.00, 5.00, 303.00, 0),
('2025-01-14', 320.00, 38.40, 0.00, 358.40, 1),('2025-01-15', 110.00, 13.20, 2.00, 121.20, 1),('2025-01-16', 500.00, 60.00, 15.00, 545.00, 0),('2025-01-17', 215.00, 25.80, 5.00, 235.80, 1),
('2025-01-18', 135.00, 16.20, 0.00, 151.20, 0),('2025-01-19', 89.00, 10.68, 0.00, 99.68, 1),('2025-01-20', 1000.00, 120.00, 50.00, 1070.00, 1);

GO
-- UPDATES DE COMPRA 
-- AUMENTA EL IVA EN  5% PARA COMPRAS ENTRE EL 5 Y 10 DE ENERO 2025
UPDATE COMPRA
SET IVA = IVA * 1.05
WHERE FECHA_REGISTRO BETWEEN '2025-01-05' AND '2025-01-10';

--MARCAR COMO PAGADO LAS COMPRAS CON MENOR A 100
UPDATE COMPRA
SET PAGADO = 1
WHERE TOTAL < 100;

--APLICAR DESCUNTO DE 10 A COMPRA CON MAYOR A 500
UPDATE COMPRA
SET DSCTO = DSCTO + 10
WHERE TOTAL > 500;



GO

--CREAR TABLA COMPRADETALLE

CREATE TABLE COMPRADETALLE
(
    IDCOMPRADETALLE INT PRIMARY KEY IDENTITY,
    IDCOMPRA INT,
    IDPRODUCTO INT,
    CANT INT,
    PRECIO REAL,
    SUBTOTAL REAL
);

GO
--INSECIONES DE COMPRADETALLE
INSERT INTO COMPRADETALLE (IDCOMPRA, IDPRODUCTO, CANT, PRECIO, SUBTOTAL) VALUES
(1, 5, 10, 2.50, 25.00),(2, 12, 4, 15.00, 60.00),(3, 7, 2, 30.00, 60.00),(4, 15, 6, 10.00, 60.00),(5, 8, 1, 100.00, 100.00),(6, 20, 3, 25.00, 75.00),(7, 10, 5, 5.00, 25.00),
(8, 18, 7, 8.00, 56.00),(9, 9, 12, 3.00, 36.00),(10, 14, 2, 50.00, 100.00),(11, 4, 6, 12.00, 72.00),(12, 3, 8, 4.00, 32.00),(13, 17, 9, 6.00, 54.00),(14, 2, 15, 2.00, 30.00),
(15, 1, 20, 1.50, 30.00),(16, 13, 2, 45.00, 90.00),(17, 11, 4, 22.00, 88.00),(18, 6, 5, 18.00, 90.00),(19, 19, 3, 40.00, 120.00),(20, 16, 10, 9.00, 90.00);

GO

--AUMENTAR LA CANTIDAD EN 2 UNIDADES A LOS PRODUCTOSCON PRECIO MAYOR A 40
UPDATE COMPRADETALLE
SET CANT = CANT + 2
WHERE PRECIO > 40;

--CAMBIAR EL PRECIO A 5 EN LOSPRODUCTOS CON IDPRODUCTOS QUE ESTEN ENTRE 5 Y 10
UPDATE COMPRADETALLE
SET PRECIO = 5
WHERE IDPRODUCTO BETWEEN 5 AND 10;


-- ACTUALIZAR EL SUBTOTAL PARA EL IDCOMPRA EN ESPECIFICO 
UPDATE COMPRADETALLE
SET SUBTOTAL = CANT * PRECIO
WHERE IDCOMPRA = 15;


-- MULTIPLICAR EL PRECIO POR 1.1 PARA COMPRADETALLE CON EL IDPRODUCTO EN UNA LISTA 
UPDATE COMPRADETALLE
SET PRECIO = PRECIO * 1.1
WHERE IDPRODUCTO IN (2, 4, 6, 8, 10);






GO
--CREAR TABLA CATEGORIA 

CREATE TABLE CATEGORIA
(
    IDCATEGORIA INT PRIMARY KEY IDENTITY,
    NOMBRE VARCHAR(100)
);
GO
-- INSERCIONES DE CATEGORIA 
INSERT INTO CATEGORIA (NOMBRE) VALUES
('Bebidas'),('Lácteos'),('Carnes'),('Frutas'),('Verduras'),('Cereales'),('Panadería'),('Dulces'),('Snacks'),('Aseo Personal'),
('Limpieza'),('Electrónica'),('Juguetes'),('Ropa'),('Zapatos'),('Accesorios'),('Medicinas'),('Papelería'),('Hogar'),('Ferretería');
GO

SELECT * FROM CATEGORIA


-- UPDATES DE CATEGORA 
-- CAMBIAR LAS QUE TENGAN UNA "a" EN SU NOMBRE POR "Alimentos"
UPDATE CATEGORIA
SET NOMBRE = 'Alimentos'
WHERE NOMBRE LIKE '%a%';
-- CAMBIAR EL QUE TENGA EL ID DE "12" POR "Tecnologia"
UPDATE CATEGORIA
SET NOMBRE = 'Tecnología'
WHERE IDCATEGORIA = 12;
--CAMBIAR EL ID "1,2,3,4" POR "Productos Basicos"
UPDATE CATEGORIA
SET NOMBRE = 'Productos Básicos'
WHERE IDCATEGORIA IN (1, 2, 3, 4);

